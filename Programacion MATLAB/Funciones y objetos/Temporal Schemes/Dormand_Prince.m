function U = Dormand_Prince(U, F, dt, time)

    k1 = dt*F(U, time);
    k2 = dt*F(U + k1/5, time + dt/5);
    k3 = dt*F(U + 3/40*k1+9/40*k2, time + 3*dt/10);
    k4 = dt*F(U +44/45*k1 -56/15*k2 +	32/9*k3, time +4/5*dt);
    k5 = dt*F(U +19372/6561*k1 -25360/2187*k2 +64448/6561*k3 -212/729*k4, time + 8/9*dt);
    k6 = dt*F(U +9017/3168*k1 -355/33*k2 +46732/5247*k3 +49/176*k4-5103/18656*k5, time + dt);
    k7 = dt*F(U +35/384*k1 +0*k2 +500/1113*k3 +125/192*k4-2187/6784*k5+11/84*k6, time + dt);

    U = U + 5179/57600*k1 +7571/16695*k3 + 393/640*k4 - 92097/339200*k5 + 187/2100*k6 + 1/40*k7; 

end